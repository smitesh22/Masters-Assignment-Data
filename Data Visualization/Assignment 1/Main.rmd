---
title: "Main"
author: "Smitesh Patil"
date: "2023-02-09"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(ggplot2)
library(dplyr)
library(gghighlight)

df <- read.csv("Counsumer_Price_Index.csv")

df <- df %>%
  rename(Location = Ã¯..Location)

sav <- df %>%
  filter(Location %in% c("IRL", "CAN", "AUS",
                            "USA", "FRA", "DEU",
                            "ESP", "ITA", "NLD", "OECD")) %>%
  filter(Time == "2022-12") %>%
  mutate(Location = recode(Location, 
                           "IRL" = "IRELAND",
                           "AUS" = "AUSTRALIA",
                           "USA" = "UNITED STATES",
                           "DEU" = "GERMANY",
                           "CAN" = "CANADA",
                           "ESP" = "SPAIN",
                           "ITA" = "ITALY",
                           "FRA" = "FRANCE",
                           "NLD" = "NETHERLANDS")) %>%
  filter(Subject != "Energy")


order <- sav %>% 
  group_by(Location) %>% 
  summarise(sum = sum(Percentage)) %>% 
  arrange(desc(sum)) %>% 
  select(Location) %>%
  unlist() %>%
  unname()
```

```{r}

colorblind_colors <- colorBlindness::availableColors()
sav %>%
  
  ggplot(aes(x = factor(Location, order), y = Percentage)) +
  geom_col(data = filter(sav, Location == "IRELAND"), fill = colorblind_colors[2] ,linewidth=0.2, position="dodge")+
  geom_col(data = filter(sav, Location == "OECD"), fill = colorblind_colors[3] ,linewidth=0.2, position="dodge")+
  xlab("Countries --> ") +
  geom_col(data = filter(sav, !Location %in% c("OECD", "IRELAND")), fill = colorblind_colors[4] ,linewidth=0.2, position="dodge")+
  xlab("Countries --> ") +
  ylab("Increase in CPI by % -->")+
  facet_grid(~Subject, labeller = as_labeller(c("Food" = "Food",
                                                "Total" = "Total",
                                                "Total_Minus_Food_Energy" = "Excluding Food & Expenses")))+
  coord_flip()+
  labs(fill = "Country / Organization")+
  scale_fill_discrete(name = "Country / Organization", labels = c("OECD", "Other countries in OECD", "IRELAND")) + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1), 
        legend.position = "top")+
  theme_light()
```


```{r}

sav %>% 
  ggplot(aes(x = Subject, y = Percentage, color = Subject, shape = Location)) +
  geom_point(data = filter(sav, Location == "IRELAND"), shape = "square",  size = 3) + 
  geom_point(data = filter(sav, Location == "OECD"), shape = "diamond",  size = 3) +
  geom_point(data = filter(sav, !Location %in% c("OECD", "IRELAND")), shape = "circle", size = 2, position = "jitter") +
  scale_shape_manual()+
  coord_flip() +
  theme(legend.position = "top")+
  theme_light()

```