---
title: "Simple Linear Regression Assignment"
author: "Smitesh Patil, id=22223696"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output:
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Predicting 3 km Running Times based on laboratory testing.

### Study Description: 
Sixteen well-trained male middle and long distance runners performed a 3 km time trial and a number of running tests in the laboratory including their running velocity at a blood lactate concentration of 4 mmol.l-1 (v4mM).  Other variables measured were running velocity at their Lactate Threshold (vTlac), and VO2 max. All the laboratory testing took place on a motorised treadmill, and distance running performance was determined by 3 km time trials on an indoor 200m track.

### Aims: 
To investigate whether there is we can use linear regression to predict 3 km running time (minutes) from v-4mM (km per hour) in the population of well-trained male middle and long distance runners.  Hence to predict 3km running time using running velocity at blood lactate concentration 4 mmol per litre.

- Response Variable:		3km running time (`Running.Time`) measured in minutes

- Explanatory Variable:	running velocity at blood lactate concentration at 4mmol per litre (`v4mM`) measured in km/hr


```{r echo=TRUE, message=FALSE, warning=FALSE, paged.print=FALSE}
library(tidyverse)
```

### Read the data and see a few rows

```{r}
running = read.csv("3krunning.csv", header = TRUE)
head(running)
```

### Summary Statistics

Task: Calculate the summary statistics for each column in the data and describe the key features of the data. 

``` {r}
running %>%
  summarise(Mean_v4mM = mean(v4mM),
            SD_v4mM = sd(v4mM),
            Mean_vTlac = mean(vTlac),
            SD_vTlac = sd(vTlac)
            )

```

### Scatterplot

Task: Make a labelled scatterplot of `v4mM` vs `Running.Time` and interpret it.

Interpretation : On a look, it seems that the variables Running.Time and v4mM have a negative correlation. I.E as the value of Running.Time increases value of v4mM decreases.

``` {r}

ggplot(running, aes(x = v4mM , y = Running.Time))+
  geom_point()

```


### Scatterplot with smoother.

Task: Add a smooth line to the scatter plot produced in the previous task, and include the new plot below.

Interpretation : Smoothing aids us to see a pattern by plotting a line and intervals to a certain width, here we can obeserve for certain that there is a negative correlation between Running.Time and v4mM. Using pearson correlation would give us concrete proof of a negative correlation.  

``` {r}


ggplot(running, aes(x = v4mM , y = Running.Time))+
  geom_point()+
  geom_smooth()
```


Task: What does the smoother suggest regarding the suitability of a simple linear regression model for this relationship?

Interpretation : In simple linear regression, we try to fit our hypothesis (a line) by calculating error on existing hypothesis and recalculating slope and intercept. The smoother suggest we can fit a line to relatively good accuracy to predict Running.Time based on its v4mM value. A simple linear regression model, basically refers to the fact that there is a single dependent variable (v4mM) for predicting the target variable (Running.Time)

### Correlation coefficient

Task: calculate the correlation coefficient between `v4mM` vs `Running.Time` and interpret it.

Interpretation : Co relation value of -0.925857 between v4mM and Running.Time supports our interpretation that the two variables are highy correlated negatively.

``` {r}

running %>% select(v4mM, Running.Time) %>% cor()

```


### Scatterplot with line of best fit

Task: Add the line of best fit to the scatter plot produced above and interpret it.

``` {r}

ggplot(running, aes(x = v4mM , y = Running.Time))+
  geom_point()+
  geom_smooth(method = "lm", se = FALSE)
```
### Fitting a Simple Linear Regression Model
  
Task: Estimate the parameters of the line of best fit for the linear relationship between 3 km running time and v-4mM in the sample.  This can then be used for inference about the linear relationship in the population of well-trained male middle and long distance runners.

Interpretation : 

``` {r}

model = lm(Running.Time ~ v4mM, running)
model

```


### Equation of line of best fit
Task: Write down the equation of the line of best fit and also provide an interpretation of the slope and intercept. Does the intercept have a physically meaningful interpretation?

``` {r}

equation = paste("Y = ", model$coefficients[-1],"*X + ",  model$coefficients[1])
equation
```

### Make some point predictions

Task: Predict the running time (i.e. `Running.Time`) when running speed at blood lactate concentration 4 mmol/litre  (i.e. `v4mM`) are 14, 15, 16, 17, 18, 19 and 20 km per hour. 

``` {r}

v4mM_pred = data.frame(
  v4mM = c(14, 15, 16, 17, 18, 19, 20))

predict(model, newdata = v4mM_pred, interval = "prediction")

```

### Interval estimation for predicted running times

For each of the predictions produce a 95% confidence interval and 95% prediction interval, and interpret the results carefully.


### Plots with confidence and prediction intervals

Task: Add the 95% confidence and 95% prediction intervals to the scatter plot with the line of best fit, and interpret.
``` {r}
preds = predict(model, newdata = running, interval = "prediction")

df2 = cbind(running, preds)

ggplot(df2, aes(y = Running.Time, x = v4mM)) +
         geom_point() +
          stat_smooth(method = lm) +
          geom_line(aes(y = lwr), color = "red", linetype = "dashed")+
          geom_line(aes(y = upr), color = "red", linetype = "dashed")
```


### More prediction

Task: Predict the running time (i.e. `Running.Time`) when running speed at blood lactate concentration 4 mmol/litre (i.e. `v4mM`) is 18.9 km per hour. 
``` {r}

predict(model, newdata = data.frame(v4mM = 18.9))

```


Task: Why is the result here is different from 8.82, the observed running time when running speed at blood lactate concentration 4 mmol/litre (`v4mM`) is 18.9 mmol.l-1? (see observation row 4) 



Task: Predict the running time (i.e. `Running.Time`) when  `v4mM` is 2.6 km per hour. Explain if you have any concern related to this prediction.  

``` {r}

predict(model, newdata = data.frame(v4mM = 2.6))

```


### Overall Conclusion 

Task: State your overall conclusions from fitting a linear model for the relationship between 3k running time and the running speed at blood lactate concentration 4 mmol/litre.



